 In smart grids demand side management is one of the important mechanism since it can reduce the total electricity cost of each customer meanwhile alleviates the aggregate peak to average ratio subject to real time pricing policy . On the other hand with the growth of bidirectional charging discharging Plug in Electric vehicles the capability of storing electrical energy for load shifting and energy sharing among users may take smart grid to a next level . In the viewpoint of a community we design a fairness strategy and apply particle swarm optimization to get the near optimal sharing schedule within community and share PEVs battery with neighbors to reduce the total electricity cost and peak to average ratio . On the other hand we try to utilize the PEVs which park at the commercial building during working hour to be involved with part of the buildings power consumption . In the simulation we have collected ten daily activity profiles from ten different people to represent the residents in the community and use the hourly load profile data from the Office of Energy Efficiency Renewable Energy for a commercial sector . The results show that the proposed DSM system not only reduces the electricity cost for each household but also reduces the PAR of the community . Moreover for the commercial building the proper rearrangement of PEVs behavior also helps to reduce the total electricity cost and PAR .

@highlight A demand side management system using particle swarm optimization.
@highlight Calculates the optimal activity schedule based on user preferences profile.
@highlight Considers selling energy back to grid home energy storage renewable energy and EV.
@highlight Helps the community sharing PEVs energy within a profitable and fair strategy.
@highlight The problem of multiple PEVs charging in the commercial building is also solved.
