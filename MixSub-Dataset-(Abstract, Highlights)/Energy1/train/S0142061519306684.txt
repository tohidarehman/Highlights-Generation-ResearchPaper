 This paper proposes a robust hierarchical control technique for islanded smart microgrids . The proposed technique is composed of three control levels to optimally adjust the microgrid voltage and frequency and improve its power quality by reducing the total harmonic distortion in islanded mode . The primary control level is based on adjusting the MG voltage and frequency to an acceptable limit after the system load variations using the droop controller . The secondary control level is depending on retaining the MG voltage and frequency to their nominal values after any load changes by proposing a multi stage H infinity controller . The tertiary control level is proposed to optimally evaluate the multi stage H controller weighted parameters based on the harmony search optimization algorithm . To verify the effectiveness of the proposed hierarchical control technique a model predictive control method is designed and simulated . For the sake of comparison between the two methods different indices are used including maximum frequency deviation integral of square error THD and controller response time . Robustness analysis is performed based on the impact of line impedance changes and filter parameters variations . Moreover the system stability is analyzed based on the system step response singular value decomposition and the bode diagram . The proposed control technique and the MPC method are modeled and simulated using MATLAB Simulink program . The results are reported and analyzed to prove the effectiveness of the proposed control technique .

@highlight The hierarchical control technique is proposed to optimally adjust the MG performance.
@highlight The islanded MG voltage and frequency and also the system power quality are improved.
@highlight The MPC method is designed for the sake of comparison with the proposed method.
@highlight Stability analysis based on step response SVD and bode diagram is performed.
@highlight The robustness of the proposed controller is analyzed in presence of uncertainties.
