 With the widespread development of microgrids in future smart distribution networks a number of neighboring MGs can be connected and form a multi microgrid cluster . In this regard the energy management of a MMG is challenging due to more complex components and higher degrees of uncertainty in a small region of power system . Likewise in the islanded MMG clusters due to the low inertia and high intermittent energy delivery of renewable resources the frequency security should be considered in the energy management . To address this issue this paper proposes an energy management system in which hierarchical control structure of IMMG clusters is precisely modeled . The proposed EMS aims to minimize total operation cost of IMMG cluster while sufficient primary and secondary reserves are scheduled to preserve frequency security in a predefined range . Besides the proposed EMS provides optimal strategies for MGs to exchange energy and reserves during scheduling horizon . To consider operational uncertainties the proposed EMS is formulated as a two stage stochastic mixed integer linear programming problem that guaranties the global optimal solution . The obtained results verify that through the proposed EMS total operation cost of the IMMG cluster is minimized while the frequency can be cost effectively preserved within a pre defined secure range .

@highlight The hierarchical control structure of IMMG cluster is modeled precisely.
@highlight The joint energy and reserve scheduling problem are formulated in an IMMG cluster.
@highlight The exchanging of energy and reserve between MGs are considered within IMMG cluster.
@highlight The developed model is in MILP format that guaranties the global optimal solution.
