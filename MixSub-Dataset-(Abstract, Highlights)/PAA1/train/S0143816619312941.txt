 It is difficult to achieve automatic visual detection of aluminium profile surface defects owing to their various categories irregular shapes random distribution and unbalanced samples . Utilising the attention mechanism the unified detection method attempts to address these challenges for both common and rare defects . We formulate our method as a variant of few shot learning to recognise the common and rare defect categories . First a category representation network is applied to extract common category feature maps . Second an attention module is proposed to generate the proposal feature maps of each rare category . Third rare category feature maps are transformed from the CCMs under the guidance of the PMs . Finally the scores of each category are obtained through the spatial pooling of both CCMs and RCMs . Experimental results on our constructed dataset show that our method is effective and outperforms the state of the art methods .

@highlight A unified method recognising both common and rare categories is proposed to detect the common and rare defects of the APSD at the same time.
@highlight An attention module is developed with both channel and spatial attention branches to generate quality PMs which can significantly improve the prediction accuracy of the rare defects of the APSD.
@highlight An APSD dataset is constructed with 11 common defects and 6 rare defects which evaluates comprehensively the performance of all methods.
@highlight Experimental results show that our method achieves good performance on our constructed dataset obtaining a good balance between common and rare defects.
