 The planetary boundary layer height is a primary parameter characterizing the boundary layer and its accurate estimation is critical . The wavelet covariance transform method is a common inversion algorithm of the PBLH estimation but is subject to the problems of dilation selection and interference from clouds aerosols etc . An improved method combining the whale optimization algorithm and the top limit is proposed to overcome these difficulties and realize the automatic determination of PBLH . In particular the dilation obtained by WOA can be more accurate to several decimal places compared to the frequently used empirical integers . The proposed method is tested on different simulation and real cases and compared with radiosonde measurements . The results show that the improved method is accurate effective and stable for automatic retrieval of PBLH based only on simple micropulse lidar without the aid of other measurements .

@highlight A novel method of dilation determination is proposed which is more accurate to several decimal places compared to the frequently used empirical integers.
@highlight Top limit is verified to be effective in reducing the interference of the cloud layer residual layer etc.
@highlight The improved method is accurate effective and stable for automatic retrieval of PBLH based only on simple micropulse lidar MPL without the aid of other measurements.
@highlight This work overcomes the main problems of wavelet covariance transform WCT method and is beneficial to the popularization and application of the WCT method.
