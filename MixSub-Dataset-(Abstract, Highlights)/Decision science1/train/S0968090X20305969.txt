 Train stop plans and timetables play key roles in railway operation . Previous research has demonstrated that their integration can significantly improve the quality of a train timetable especially for commuter railways with flexible service frequencies and multiple stop plans . However solving the dilemma of the mathematical tractability and practicality of the model is still an open challenge . To obtain a high quality timetable and simultaneously consider more realistic conditions an integrated combination optimization model of both train stop plans and timetables under time dependent passenger demand is proposed in this article . More realistic conditions such as no predefined schedule a variable total number of trains and oversaturation are taken into account . The problem is modeled as a mixed integer nonlinear programming problem to optimize passenger travel efficiency and mainly consists of the total waiting time at stations the delay time for trains due to a train stop and the minimization of the total train running time . An extended adaptive large scale neighborhood search algorithm is developed to solve the problem . A numerical experiment is designed to test the validity of the model and the algorithm . Then the integrated approach is applied in a real world case . The results show that the proposed approach can simultaneously reduce the passenger total waiting time and delay time as well as the train running time within a short computation time and demonstrate the effectiveness of the model and the approach .

@highlight Develop integrated model to optimize the train stop plan and timetable under time dependent passenger demand.
@highlight Improves passenger travel efficiency and reduces train running costs.
@highlight The number of trains and stops can be changed freely oversaturation is permitted.
@highlight Improved extended adaptive large neighborhood search approach for solving.
