 A large portion of passenger requests is reportedly unserviced partially due to vacant for hire drivers cruising behavior during the passenger seeking process . This paper aims to model the multi driver repositioning task through a mean field multi agent reinforcement learning approach that captures competition among multiple agents . Because the direct application of MARL to the multi driver system under a given reward mechanism will likely yield a suboptimal equilibrium due to the selfishness of drivers this study proposes a reward design scheme with which a more desired equilibrium can be reached . To effectively solve the bilevel optimization problem with upper level as the reward design and the lower level as a multi agent system a Bayesian optimization algorithm is adopted to speed up the learning process . We then apply the bilevel optimization model to two case studies namely e hailing driver repositioning under service charge and multiclass taxi driver repositioning under NYC congestion pricing . In the first case study the model is validated by the agreement between the derived optimal control from BO and that from an analytical solution . With a simple piecewise linear service charge the objective of the e hailing platform can be increased by

@highlight Multi agent reinforcement learning is applied to driver repositioning contexts.
@highlight A multi class MARL is applied to a case study using NYC taxi data.
@highlight The first to propose an optimal reward design to guide drivers selfish behavior towards social optima.
