 Sags and tunnels are major bottlenecks where the road capacity is reduced and the capacity drop phenomenon occurs however there is no simple model or theory that can explain the formation and other characteristics of capacity drop . This paper presents a car following model which is equivalent to a continuum model in the Lagrangian coordinates . The model is built on two main assumptions inhomogeneous fundamental diagrams with location dependent time gaps and bounded acceleration . We first demonstrate that the stationary speed profiles the low acceleration rates the dropped capacity and the approximate time duration of the capacity drop formation in the model are consistent with empirical observations . Then the impacts on the stationary states and dropped capacity of the numerical viscosity caused by the discretization method are investigated and it is shown that the dropped capacity converges to the theoretical value . Further a one dimensional iterated function system is proposed to model the formation mechanism of the capacity drop which is derived by investigating the spatial pattern of equilibrium and bounded acceleration traffic states that arises in a lead vehicle problem . Utilizing this model we uncover a set of properties of the capacity drop such as existence uniqueness global convergence and convergence speed . Finally the model is applied to analyze the impacts of heterogeneous drivers . The model and insights in this study will help to develop control and management schemes to alleviate capacity drop effects with connected and autonomous vehicles in the future .

@highlight Present a continuum car following model of capacity drop at sag and tunnel bottlenecks.
@highlight Demonstrate the occurrence of the capacity drop and compare its characteristics to the known empirical observations.
@highlight Analyze the effects of a numerical viscosity on the capacity drop and the consistency with the KW model.
@highlight Devise an iterated function system model to analyze the temporal formation and stabilized mechanisms of capacity drop.
@highlight Apply the model to analyze the impacts of heterogeneous drivers.
