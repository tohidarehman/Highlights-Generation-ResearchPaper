 Macroscopic fundamental diagram has been receiving increasing attention recently due to its potential to describe traffic dynamics and guide the design of traffic control schemes at the network level . Perimeter control and route guidance are two main MFD based traffic control approaches . However current MFD based perimeter control seldom considers travelers route choice behavior while MFD based route guidance studies usually assume directly that travelers would follow the guidance and neglect the effects of traffic control . This paper aims to integrate the MFD based perimeter control and the dynamic user equilibrium based route choice behavior into one rigorous mathematical framework . Given a traffic network that has been divided into multiple homogeneous regions we use MFD to describe the dynamics of each region and use point queue model to capture the dynamics of queues formed at the boundaries . Besides we model travelers route choice behavior by the instantaneous dynamic user equilibrium principle and design an efficient range perimeter control method from the system perspective . We model the interactions between the system manager and the travelers as a non zero sum non cooperative differential game where the system manager aims to improve the system performance while travelers try to minimize their own travel times . Meanwhile they share the common constraints . Mathematically this leads to a differential complementarity system . We propose a time stepping approach to discretize and solve the DCS model based on which the solution existence and convergence are also established . Numerical results show that the proposed method can limit the vehicle accumulations within the efficient range of each region which helps improve the network performance . Compared with the condition without perimeter control the proposed control method can improve network wide traffic performance up to 14.18 .

@highlight Point queue model is applied to model vehicle queuing at the boundary of two regions.
@highlight MFD based efficient range control determines the inflow rate to a region at the boundary.
@highlight Travelers choose routes to minimize their instantaneous travel times.
@highlight Efficient range control and instantaneous route choice can be modeled as a differential game.
@highlight The differential game modeled can be mathematically formulated as a DCS.
