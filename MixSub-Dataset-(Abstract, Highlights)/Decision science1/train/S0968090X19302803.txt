 This paper studies the trajectory planning problem for multiple aircraft in converging arrival routes in the presence of a multi cell storm in development . Storm avoidance constraints are enforced by approximating each cell of the storm as a moving and size changing ellipsoid . Besides storm avoidance constraints operational constraints such as following an arrival procedure or time based separation between aircraft are also considered . The problem is solved using nonlinear model predictive control based on hybrid optimal control with logical constraints in disjunctive form . Logical constraints in disjunctive form arise in modelling of both storm avoidance and operational constraints and also in modelling general decision making processes during flight such as establishing which among two or more actions should be taken to solve a contingency . The evolution of the storms is tackled using the nonlinear model predictive control scheme which iteratively re plans the trajectories as a new estimation of the state of the storms is available . The presence of this feedback mechanism in the trajectory planning scheme makes it substantially different from open loop trajectory planning methods . Since it is intended for trajectory planning with very short time horizon before the departure or during the flight it has been herein called online trajectory planning . An embedding approach is employed to transform logical constraints in disjunctive form into inequality and equality constraints which involve only continuous auxiliary variables . In this way the hybrid optimal control problem is converted into a smooth optimal control problem thereby reducing the computational complexity of finding the solution . The effectiveness of the approach is demonstrated through several numerical experiments .

@highlight Storm avoidance constraints are modelled using moving and size changing ellipsoid.
@highlight Besides storm avoidance constraints operational constraints are also considered.
@highlight Nonlinear model predictive control based on hybrid optimal control has been used.
@highlight An embedding approach is employed to tackle logical constraints.
@highlight The evolution of the storms is handled using the nonlinear model predictive control.
