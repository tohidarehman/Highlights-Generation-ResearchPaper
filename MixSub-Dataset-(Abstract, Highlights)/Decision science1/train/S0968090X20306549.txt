 The real time crash risk analyses were proposed to establish the relationships between crash occurrence probability and pre crash traffic operational conditions . Given its great application potentials that link with Active Traffic Management System for proactive safety management it has become an important research area . Currently researchers mainly developed the real time crash risk analysis models with traffic flow descriptive statistics employed as explanatory variables and with re sampled balanced dataset which hold the limitations of insufficiently capturing the temporal spatial traffic flow characteristics and failing to provide classification capabilities when deal with the imbalanced datasets . In this study a Convolutional Neural Network modelling approach with refined loss functions has been first time introduced to the real time crash risk analyses . The primary objectives of the proposed CNN models are utilizing the tensor based data structure to explore the multi dimensional temporal spatial correlated pre crash operational features and optimizing the loss functions to overcome the low classification accuracy issue brought by the imbalanced data . Data from the Shanghai urban expressway system were utilized for the empirical analysis . And a total of three types of loss functions including traditional binary cross entropy the weighted cross entropy and the focal loss were introduced and being tested with varying ratios of crash and non crash datasets . The modeling results show that the CNN model has better classification performance compared to the traditional Multi layer Perceptrons model with the tensor based structure data . Besides the developed CNN model with focal loss function has substantial classification enhancement under the imbalanced datasets . Finally the

@highlight Developed a tensor based structure to represent crash precursors.
@highlight Applied CNN model for multi dimensional traffic flow features extraction.
@highlight Proposed refined focal loss functions for the imbalanced data issue.
@highlight Obtained 66.8 sensitivity with 3.8 FAR result under 1 100 imbalanced ratio.
