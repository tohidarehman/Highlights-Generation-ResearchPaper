 Being different from the continuous process batch processes in the practical industry have several distinct characteristics such as the unsteady state severe nonlinearity and iterative operation . For tracking a reference trajectory of a batch process data driven model predictive controllers have been proposed with the progress of sensors and machine learning . Among them the latent variable space model based controllers have been applied to the batch processes for decades . When there exist time and batch varying trajectory and disturbance however utilization of a single model using the aggregate historical dataset may reduce the capability of the predictive model and the control performance . It is because maintaining a single global model can miss the details of process dynamics at the current state . To solve this problem we propose to update the local model in the manner of just in time learning and to use them to the predictive controller design at first . Then two different weighted similarity methods based on principal component analysis and partial least squares are proposed to enhance the performance of sorting out the most relevant dataset able to explain the current state . A fed batch bioreactor system which has time and batch varying reference trajectory and disturbance is simulated to verify the efficiency of the proposed methods . Simulation results show that weighted similarity based on PLS and its application to JITL latent variable space model predictive controller has an improved control performance as it sorts out the data with the useful information about the current dynamics .

@highlight Data driven approaches such as latent variable space model predictive controller LV MPC have been used for batch trajectory tracking problems.
@highlight LV MPC is combined with just in time learning JITL for adapting to time and batch varying data flow.
@highlight When calculating the similarity for JITL LV MPC the weighting methods based on PCA and PLS are proposed.
@highlight Comparing the control performances JITL LV MPC using the weighted similarity with PLS outperforms the other methods.
