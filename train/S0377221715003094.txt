 In this paper we present an efficient two-stage hierarchical decomposition algorithm aiming at determining economically improved operation schedules for residential proton exchange membrane fuel cell micro-combined heat and power (PEMFC micro-CHP) units and optimizing local charging of electric vehicles (EV) in the same household. Based on an individual short-term load forecasting (STLF) approach (imperfect forecast) for households implemented as an adaptive network-based fuzzy inference system (ANFIS), a mixed-integer linear program (MILP) and a two-stage greedy algorithm are used for determining optimized schedules based on a rolling-window approach. The results of the case study performed for eight variants in exemplary German households reveal that with both the MILP and the algorithmic approach, significant economic savings can be achieved compared to the standard heat-led strategy. Compared to the MILP, however, the two-stage algorithm has the additional advantage of a reduced computing time of only about 15 . Deviations from the MILP solutions are mostly smaller than 3 percent regarding the annual supply costs. Moreover, the comparison between the use of perfect and imperfect demand forecasts quantifies additional average losses due to forecasting errors of 2 percent and 3.3 percent at the maximum. Altogether, the algorithmic approach seems to be convincing for real applications in households due to its good results, high reliability, easy implementation, and short computing times. The combination of a micro-CHP unit and an EV is highly synergetic.

@highlight We develop an efficient algorithm for scheduling CHP units with electric vehicles.
@highlight Our method is tested within a case study of two German households.
@highlight We apply individual short-term load forecasting approach implemented as an ANFIS.
@highlight The computing time could be reduced to about
@highlight 15
@highlight compared to the MILP.
@highlight The deviations from the MILP solution regarding the annual supply costs are small.
