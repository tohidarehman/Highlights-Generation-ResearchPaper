 Deformable image registration remains a challenging research area due to difficulties associated with local intensity variation and large motion. In this paper, an Accurate Inverse-consistent Symmetric Optical Flow (AISOF) method is proposed to overcome these difficulties. The two main contributions of AISOF include the following:  a coarse-to-fine strategy for an inverse-consistent symmetric method and  a novel Hybrid Local Binary Pattern (HLBP) to the classical Lucas–Kanade optical flow method. The HLBP consists of a median binary pattern and a generalised centre-symmetric local binary pattern. The generalised centre-symmetric local binary pattern has two thresholds, and this pattern can capture more information than the classical centre-symmetric local binary pattern, which has one threshold. The proposed HLBP can cope well with high contrast intensity and local intensity variation. Because the inverse-consistent symmetric method can reduce inverse consistency errors in Markov random fields based registration methods, we adopted this method to improve the accuracy of registration. In addition, a coarse-to-fine strategy was adopted to handle large motion. The proposed AISOF method was evaluated for 10 publicly available 4D CT lung datasets from the DIR-Lab. The mean target registration error of the AISOF method is 1.16mm, which is significantly superior to the error of the classical Lucas–Kanade optical flow method, 2.83mm. Moreover, this error is also the smallest of all unmasked registration methods using these datasets.

@highlight The classical centre-symmetric local binary pattern is generalised to generate distinctive features.
@highlight A novel hybrid local binary pattern is proposed.
@highlight A novel method based on Lucas-Kanade algorithm and the novel hybrid pattern is proposed.
@highlight The proposed method is inverse-consistent.
@highlight The proposed method yields the most accurate results of all the unmasked methods tested on the 4D CT datasets from the DIR-lab.
