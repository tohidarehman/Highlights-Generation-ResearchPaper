 The joint estimation of the parameters and the states of the hemodynamic model from the blood oxygen level dependent (BOLD) signal is a challenging problem. In the functional magnetic resonance imaging (fMRI) literature, quite interestingly, many proposed algorithms work only as a filtering method. This makes the estimation of hidden states and parameters less reliable compared with the algorithms that use smoothing. In standard implementations, smoothing is performed only once. However, joint state and parameter estimation can be improved substantially by iterating smoothing schemes such as the extended Kalman smoother (IEKS). In the fMRI literature, extended Kalman filtering is thought to be less accurate than standard particle filtering (PF). We compared EKF with PF and observed that the contrary is true. We improved the EKF performance by adding smoother. By iterative scheme joint hemodynamic and parameter estimation is improved substantially. We compared IEKS performance with the square-root cubature Kalman smoother (SCKS) algorithm. We show that its accuracy for the state and the parameter estimation is better and much faster than iterative SCKS. SCKS was found to be a better estimator than the dynamic expectation maximization (DEM), EKF, local linearization filter (LLF) and PF methods. We show in this paper that IEKS is a better estimator than iterative SCKS under different process and measurement noise conditions. As a result, IEKS seems to be the best method we evaluated in all aspects.

@highlight In a former paper which is accepted in this journal (which is under revision) we implemented several filtering methods for hemodynamic state estimation. There we showed in detail that the hemodynamic model is weakly non-linear. Based on that finding we extended our researched by implementing a successful joint hemodynamic state and parameter estimation method. We also implemented the algorithm to a real fMRI data set.
@highlight We emphasized the following point in the literature. It is alleged that extended Kalman filter is unrobust and poor in performance. We carefully examined this allegation under various state/measurement noise conditions. This allegation is not true for the widely used hemodynamic model in a wide range of process and measurement noise conditions. Furthermore, several times particle filters are alleged to outperform Extended Kalman Filters. The alleged EKF is shown to be better in state estimation. We examined carefully and showed the contrary is true.
@highlight By smoother we improved the estimation even more. The alleged unrobust filter is shown even to accurately perform joint parameter and state estimation. The parameter estimation scheme is achieved by adding artificial dynamics to the parameters. In that perspective, parameters are augmented to the state vector.
@highlight The iterative scheme is applied for the joint parameter and state estimation. In the standard implementation of smoother there is no iteration. We compared iterative performance and noted substantial improvement in performance.
@highlight Iterative extended Kalman smoother (IEKS) is compared with the most successful algorithm in the fMRI model inversion literature. IEKS was 2.3 times faster and (though not big difference) always better in state and parameter estimates. The comparison is made under a wide range of process/measurement noise conditions.
