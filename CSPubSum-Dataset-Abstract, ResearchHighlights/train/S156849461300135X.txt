 A methodology for designing semi-physical fuzzy models is proposed. Prior physical knowledge about the dynamics of the system is modeled with continuous time differential equations. Fuzzy knowledge bases are embedded in these equations as nonlinear constructive blocks. Rules comprising the knowledge bases are fitted to interval-valued data with metaheuristics. A possibilistic filter is proposed that is able to gradually evolve an initial estimation of the latent variables of the model on the basis of successive prediction errors. This methodology has been applied to the prediction of voltage and state of charge of LiFePO4 batteries. An empirical study has been carried over data gathered in experiments at the Battery Laboratory at Oviedo University. Fitting between the proposed model and actual measurements is studied for four different manufacturers and different chargeâ€“discharge patterns. Predictions of the evolution of the voltage during charge, discharge and inactivity compare favorably to different models in the literature. The possibilistic filter allows to estimate the state of charge of batteries after an arbitrary path that may include partial charges and discharges. It is shown that the accuracy of the open loop model improves that of other approaches in the literature, and at the same time the observer-based online model is able to approximate the effective remnant charge of the battery after a reasonably short time.

@highlight Methodology for obtaining fuzzy rule-based semi-physical models.
@highlight Possibilistic maximally specific observer of the state of a nonlinear system.
@highlight Mathematical model of open circuit voltage and state of charge of LiFePO4 batteries.
