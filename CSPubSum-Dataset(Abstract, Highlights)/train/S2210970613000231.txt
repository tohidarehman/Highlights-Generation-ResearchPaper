 This paper presents a timetable rescheduling algorithm based on Mixed Integer Programming (MIP) formulation when train traffic is disrupted. We minimize further inconvenience to passengers instead of consecutive delays caused by the disruption, since loss of time and satisfaction of the passengers are considered implicitly and insufficiently in the latter optimization. We presume that inconvenience of traveling by train consists of the traveling time on board, the waiting time at platforms and the number of transfers. Hence, the objective function is calculated on the positive difference between the inconvenience which each passenger suffers on his/her route in a rescheduled timetable and that in a planned timetable. The inconvenience-minimized rescheduling is often achieved at the cost of further train delays. Some trains dwell longer at a station to wait for extra passengers to come or to keep a connection, for instance. In the MIP model, train operation, each passenger’s behavior and the amount inconvenience are simultaneously expressed by a system of integer linear inequalities. As countermeasures against the disruption, changes of train types and rolling stock operation schedules at termini as well as changes of departing order of trains and assignment of a track to trains in stations are performed. We also consider capacities of a line between adjacent stations as well as those of a track in stations. We have conducted numerical experiments using actual data and have obtained better rescheduled timetables in terms of customer satisfaction within practical time in proper solution space. set of train directions opposite direction of set of trains set of trains traveling in set of ordered pair of distinct trains traveling in set of candidate successor trains of set of stations starting station of trains traveling in terminus of trains traveling in station next to in set of O–D pair of stations in set of stations at which passengers to in can transfer station next to in at which passengers can transfer set of tracks at which trains traveling in can pass through or stop at set of train types set of train types which stop at set of train types which passengers can take at s to reach d where priority relation between two train types set of discrete time periods set of two pairs with whose behavior is same when they appear at same time arrival/departure time of at in planned timetable amount of inconvenience to passengers between appearing at in planned timetable arrival/departure time of at in certain feasible rescheduled timetable minimum interval required between arrivals and departures arbitrary large number concerning headway/inconvenience maximum number of trains traveling in allowed to exist on line between Next number of passengers between appearing at inconvenience of waiting for 1min at platform inconvenience of one train transfer flexibility in timetable to be rescheduled arrival/departure time of at 0–1 if or not type of is 0–1 if or not passes through or stops at 0–1 if or not successor of is Suc 0–1 if or not departs from Term } earlier than 0–1 if or not arrives at Term(b) earlier than Opp departs from 0–1 if or not Opp departs from Term(b) earlier than arrives at 0–1 if or not trains depart from s after and before does 0–1 if or not passengers between appearing at take 0–1 if or not passengers to at Tra transfer from to amount of inconvenience to passengers to d when they take at s where increased amount of inconvenience to passengers between appearing at taking

@highlight A timetable recovery MIP model minimizing inconvenience to passengers is proposed.
@highlight Train operation and passenger’s behavior are expressed by inequalities.
@highlight Several countermeasures against a disruption are implemented.
@highlight Inconvenience consists of travel by a train, a wait for a train, a train transfer.
